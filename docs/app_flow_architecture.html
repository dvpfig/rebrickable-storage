<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebrickable Storage - Application Analysis</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            display: block;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #ddd;
            padding: 0 30px;
        }
        
        .tab {
            padding: 15px 30px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1em;
            color: #666;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            color: #667eea;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }
        
        .tab-content {
            display: none;
            padding: 40px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        pre {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .function-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .function-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .function-name {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }
        
        .function-module {
            color: #666;
            font-size: 0.85em;
        }
        
        .function-params {
            color: #888;
            font-size: 0.85em;
            font-family: monospace;
        }
        
        .folder-section {
            margin-bottom: 30px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .folder-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: bold;
            font-size: 1.1em;
            transition: background 0.3s;
        }
        
        .folder-header:hover {
            background: linear-gradient(135deg, #5568d3 0%, #653a8b 100%);
        }
        
        .folder-icon {
            font-size: 1.2em;
            margin-right: 10px;
        }
        
        .folder-count {
            background: rgba(255, 255, 255, 0.2);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.85em;
        }
        
        .file-section {
            margin: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            overflow: hidden;
        }
        
        .file-header {
            background: #f8f9fa;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            color: #333;
            transition: background 0.3s;
        }
        
        .file-header:hover {
            background: #e9ecef;
        }
        
        .file-icon {
            color: #667eea;
            margin-right: 8px;
        }
        
        .file-count {
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8em;
        }
        
        .functions-container {
            padding: 15px;
            background: white;
            display: none;
        }
        
        .functions-container.expanded {
            display: block;
        }
        
        .folder-content {
            display: none;
            background: #fafafa;
        }
        
        .folder-content.expanded {
            display: block;
        }
        
        .function-item {
            background: white;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 4px;
            border-left: 3px solid #667eea;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .function-item:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .function-item-name {
            font-weight: bold;
            color: #667eea;
            font-family: monospace;
            margin-bottom: 4px;
        }
        
        .function-item-params {
            color: #666;
            font-size: 0.85em;
            font-family: monospace;
        }
        
        .expand-icon {
            transition: transform 0.3s;
            display: inline-block;
        }
        
        .expand-icon.rotated {
            transform: rotate(90deg);
        }
        
        footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
        
        .timestamp {
            color: #999;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üß± Rebrickable Storage</h1>
            <p>Application Architecture Analysis</p>
        </header>
        
        <div class="stats">
            <div class="stat-card">
                <span class="stat-number">164</span>
                <span class="stat-label">Functions</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">11</span>
                <span class="stat-label">Classes</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">18</span>
                <span class="stat-label">Session Keys</span>
            </div>
            <div class="stat-card">
                <span class="stat-number">4</span>
                <span class="stat-label">Pages</span>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('overview')">Overview</button>
            <button class="tab" onclick="showTab('pages')">Pages</button>
            <button class="tab" onclick="showTab('architecture')">Architecture</button>
            <button class="tab" onclick="showTab('metrics')">Metrics</button>
            <button class="tab" onclick="showTab('functions')">Functions</button>
            <button class="tab" onclick="showTab('flow')">Flow Diagram</button>
        </div>
        
        <div id="overview" class="tab-content active">
            <h2>Application Overview</h2>
            <p>This report provides a comprehensive analysis of the Rebrickable Storage application architecture, 
            including execution flow, user experience journey, data structures, and module dependencies.</p>
            
            <h3 style="margin-top: 30px;">Key Components</h3>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li><strong>Core Modules:</strong> Authentication, path management, data preprocessing, image handling, color mapping, label generation</li>
                <li><strong>UI Modules:</strong> Theme management, layout helpers, summary tables</li>
                <li><strong>Data Flow:</strong> CSV upload ‚Üí validation ‚Üí merging ‚Üí enrichment ‚Üí display ‚Üí export</li>
                <li><strong>Storage:</strong> User-specific data directories, shared image cache, session persistence</li>
            </ul>
            
            <h3 style="margin-top: 30px;">Session State Keys</h3>
            <div class="function-list">
                <div class="function-card"><div class="function-name">collection_df</div></div><div class="function-card"><div class="function-name">expanded_loc</div></div><div class="function-card"><div class="function-name">found_counts</div></div><div class="function-card"><div class="function-name">labels_zip_bytes</div></div><div class="function-card"><div class="function-name">labels_zip_filename</div></div><div class="function-card"><div class="function-name">last_activity</div></div><div class="function-card"><div class="function-name">locations_index</div></div><div class="function-card"><div class="function-name">merged_df</div></div><div class="function-card"><div class="function-name">merged_source_hash</div></div><div class="function-card"><div class="function-name">selected_sets_for_search</div></div><div class="function-card"><div class="function-name">session_timeout_logged</div></div><div class="function-card"><div class="function-name">set_found_counts</div></div><div class="function-card"><div class="function-name">set_search_results</div></div><div class="function-card"><div class="function-name">sets_data_loaded</div></div><div class="function-card"><div class="function-name">sets_inventories_cache</div></div><div class="function-card"><div class="function-name">sets_metadata</div></div><div class="function-card"><div class="function-name">show_set_selection</div></div><div class="function-card"><div class="function-name">start_processing</div></div>
            </div>
        </div>
        
        <div id="pages" class="tab-content">
            <h2>Multi-Page Navigation</h2>
            <p>The application uses Streamlit's multi-page navigation with 4 pages organized by functionality.</p>
            
            <h3 style="margin-top: 30px;">Page Structure</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white;">1_Rebrickable_Storage</h4>
                    <p style="margin: 5px 0; opacity: 0.9;">1_Rebrickable_Storage</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìÑ pages\1_Rebrickable_Storage.py</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìù 90 lines of code</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üîß 1 core imports</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üé® 5 UI elements</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white;">2_My_Collection_Parts</h4>
                    <p style="margin: 5px 0; opacity: 0.9;">üè∑Ô∏è My Collection - Parts</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìÑ pages\2_My_Collection_Parts.py</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìù 697 lines of code</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üîß 15 core imports</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üé® 46 UI elements</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white;">3_My_Collection_Sets</h4>
                    <p style="margin: 5px 0; opacity: 0.9;">üì¶ My Collection - Sets</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìÑ pages\3_My_Collection_Sets.py</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìù 403 lines of code</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üîß 4 core imports</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üé® 30 UI elements</p>
                </div>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px;">
                    <h4 style="margin: 0 0 10px 0; color: white;">4_Find_Wanted_Parts</h4>
                    <p style="margin: 5px 0; opacity: 0.9;">üîç Find Wanted Parts</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìÑ pages\4_Find_Wanted_Parts.py</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üìù 351 lines of code</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üîß 12 core imports</p>
                    <p style="margin: 5px 0; font-size: 0.9em; opacity: 0.8;">üé® 12 UI elements</p>
                </div>
                
            </div>
            
            <h3 style="margin-top: 30px;">User Navigation Flow</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 15px;">
                <ol style="margin-left: 20px;">
                    <li style="margin: 10px 0;"><strong>app.py (Landing)</strong> - User authentication and welcome screen</li>
                    <li style="margin: 10px 0;"><strong>1_Rebrickable_Storage.py</strong> - Main dashboard with navigation to other pages</li>
                    <li style="margin: 10px 0;"><strong>2_My_Collection.py</strong> - Manage collection files and generate labels</li>
                    <li style="margin: 10px 0;"><strong>3_Find_Wanted_Parts.py</strong> - Find parts in collection and track progress</li>
                </ol>
            </div>
            
            <h3 style="margin-top: 30px;">Page Complexity Metrics</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 15px;">
                <canvas id="pageChart" style="max-height: 300px;"></canvas>
            </div>
            
            <h3 style="margin-top: 30px;">Detailed Page Metrics</h3>
            <div style="margin-top: 15px;">
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                    <h4 style="margin: 0 0 10px 0;">1_Rebrickable_Storage</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div>
                            <strong>Lines of Code:</strong> 90
                        </div>
                        <div>
                            <strong>Core Imports:</strong> 1
                        </div>
                        <div>
                            <strong>UI Elements:</strong> 5
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>UI Element Breakdown:</strong>
                        <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                            <li>File Uploaders: 0</li>
                            <li>Buttons: 3</li>
                            <li>Expanders: 0</li>
                            <li>Columns: 2</li>
                            <li>Checkboxes: 0</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                    <h4 style="margin: 0 0 10px 0;">2_My_Collection_Parts</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div>
                            <strong>Lines of Code:</strong> 697
                        </div>
                        <div>
                            <strong>Core Imports:</strong> 15
                        </div>
                        <div>
                            <strong>UI Elements:</strong> 46
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>UI Element Breakdown:</strong>
                        <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                            <li>File Uploaders: 2</li>
                            <li>Buttons: 23</li>
                            <li>Expanders: 10</li>
                            <li>Columns: 9</li>
                            <li>Checkboxes: 0</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                    <h4 style="margin: 0 0 10px 0;">3_My_Collection_Sets</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div>
                            <strong>Lines of Code:</strong> 403
                        </div>
                        <div>
                            <strong>Core Imports:</strong> 4
                        </div>
                        <div>
                            <strong>UI Elements:</strong> 30
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>UI Element Breakdown:</strong>
                        <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                            <li>File Uploaders: 1</li>
                            <li>Buttons: 12</li>
                            <li>Expanders: 4</li>
                            <li>Columns: 10</li>
                            <li>Checkboxes: 0</li>
                        </ul>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                    <h4 style="margin: 0 0 10px 0;">4_Find_Wanted_Parts</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                        <div>
                            <strong>Lines of Code:</strong> 351
                        </div>
                        <div>
                            <strong>Core Imports:</strong> 12
                        </div>
                        <div>
                            <strong>UI Elements:</strong> 12
                        </div>
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>UI Element Breakdown:</strong>
                        <ul style="margin: 5px 0 0 20px; font-size: 0.9em;">
                            <li>File Uploaders: 2</li>
                            <li>Buttons: 8</li>
                            <li>Expanders: 0</li>
                            <li>Columns: 1</li>
                            <li>Checkboxes: 1</li>
                        </ul>
                    </div>
                </div>
                
            </div>
            
            <h3 style="margin-top: 30px;">Page Features</h3>
            <div style="margin-top: 15px;">
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #2196F3;">
                    <h4 style="margin: 0 0 10px 0;">üè† Rebrickable Storage (Main Dashboard)</h4>
                    <ul style="margin-left: 20px;">
                        <li>Getting started guide</li>
                        <li>Navigation to other pages</li>
                        <li>Change password functionality</li>
                        <li>App overview and features</li>
                    </ul>
                </div>
                
                <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #4CAF50;">
                    <h4 style="margin: 0 0 10px 0;">üè∑Ô∏è My Collection</h4>
                    <ul style="margin-left: 20px;">
                        <li>Upload and manage collection CSV files</li>
                        <li>Generate printable labels by location</li>
                        <li>Manage custom part images</li>
                        <li>View collection statistics</li>
                    </ul>
                </div>
                
                <div style="background: #fff3e0; padding: 15px; border-radius: 8px; border-left: 4px solid #FF9800;">
                    <h4 style="margin: 0 0 10px 0;">üîç Find Wanted Parts</h4>
                    <ul style="margin-left: 20px;">
                        <li>Upload wanted parts lists</li>
                        <li>Match against collection</li>
                        <li>Precompute collection images</li>
                        <li>Generate pickup list by location</li>
                        <li>Mark parts as found</li>
                        <li>View color alternatives</li>
                        <li>Save/load progress</li>
                        <li>Download merged results</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="architecture" class="tab-content">
            <h2>Architecture Overview</h2>
            
            <h3>Technology Stack</h3>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li><strong>Frontend:</strong> Streamlit (Web UI Framework)</li>
                <li><strong>Authentication:</strong> streamlit-authenticator, bcrypt, PyYAML</li>
                <li><strong>Data Processing:</strong> pandas, requests</li>
                <li><strong>Storage:</strong> Local filesystem (Development), JSON (Session serialization)</li>
            </ul>
            
            <h3 style="margin-top: 30px;">Session State Management</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                    <h4>Global (Shared)</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>ba_mapping - Part number mappings</li>
                        <li>color_lookup - Color database</li>
                        <li>theme - UI theme preference</li>
                    </ul>
                </div>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                    <h4>User-Specific (Isolated)</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>username - Current user</li>
                        <li>authenticated - Auth status</li>
                        <li>collection_df - User's collection</li>
                        <li>found_counts - Parts marked as found</li>
                        <li>locations_index - Location grouping</li>
                        <li>merged_df - Matched parts</li>
                    </ul>
                </div>
            </div>
            
            <h3 style="margin-top: 30px;">External Integrations</h3>
            <ul style="margin-left: 20px; margin-top: 10px;">
                <li><strong>Rebrickable API:</strong> Part data and mappings</li>
                <li><strong>BrickArchitect Images:</strong> Part images (cached locally)</li>
            </ul>
            
            <h3 style="margin-top: 30px;">Deployment</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 15px;">
                <div style="background: #e3f2fd; padding: 20px; border-radius: 8px;">
                    <h4>Development</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>localhost:8501</li>
                        <li>File-based storage</li>
                        <li>Local user_data/</li>
                        <li>YAML configuration</li>
                    </ul>
                </div>
                <div style="background: #e8f5e9; padding: 20px; border-radius: 8px;">
                    <h4>Production (Recommended)</h4>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>HTTPS with SSL/TLS</li>
                        <li>Database backend (PostgreSQL/MongoDB)</li>
                        <li>Cloud storage (S3/Azure Blob)</li>
                        <li>Environment secrets management</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div id="metrics" class="tab-content">
            <h2>Runtime Metrics & Data Dimensions</h2>
            
            <h3>Resource Data</h3>
            <div class="function-list">
                <div class="function-card">
                    <div class="function-name">Colors Database</div>
                    <div class="function-module">273 rows √ó 8 columns</div>
                </div>
                <div class="function-card">
                    <div class="function-name">Part Mappings (BA ‚Üî RB)</div>
                    <div class="function-module">4446 rows √ó 84 columns</div>
                </div>
            </div>
            
            
            <h3 style="margin-top: 30px;">Data Structure Dimensions</h3>
            <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-top: 15px;">
                <h4>DataFrame Schemas</h4>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>wanted_df:</strong> ~4-5 columns (Part, Color, Quantity, Location)</li>
                    <li><strong>collection_df:</strong> ~4 columns (Part, Color, Quantity, Location)</li>
                    <li><strong>merged_df:</strong> ~8-10 columns (includes Image URL, Color data)</li>
                </ul>
                
                <h4 style="margin-top: 20px;">Dictionary Structures</h4>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li><strong>found_counts:</strong> {(part, color, location): count}</li>
                    <li><strong>locations_index:</strong> {location: [image_urls]}</li>
                    <li><strong>ba_mapping:</strong> {ba_part_number: rb_part_number}</li>
                    <li><strong>color_lookup:</strong> {color_id: {name, rgb, ...}}</li>
                </ul>
            </div>
        </div>
        
        <div id="functions" class="tab-content">
            <h2>Function Reference</h2>
            <p>All functions discovered in the application (164 total) - organized by folder and file</p>
            
            <div style="margin: 20px 0;">
                <button onclick="expandAll()" style="padding: 10px 20px; margin-right: 10px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                    ‚ñº Expand All
                </button>
                <button onclick="collapseAll()" style="padding: 10px 20px; background: #764ba2; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 0.9em;">
                    ‚ñ∂ Collapse All
                </button>
            </div>
            
            
            <div class="folder-section">
                <div class="folder-header" onclick="toggleFolder('folder-0')">
                    <div>
                        <span class="folder-icon">üìÑ</span>
                        <span>Root Files</span>
                    </div>
                    <div>
                        <span class="folder-count">164 functions</span>
                        <span class="expand-icon" id="folder-0-icon">‚ñ∂</span>
                    </div>
                </div>
                <div class="folder-content" id="folder-0-content">
        
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-0')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\auth\api_keys.py</span>
                            </div>
                            <div>
                                <span class="file-count">3</span>
                                <span class="expand-icon" id="folder-0-file-0-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-0-content">
            
                            <div class="function-item">
                                <div class="function-item-name">delete_api_key</div>
                                <div class="function-item-params">(user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_api_key</div>
                                <div class="function-item-params">(user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_api_key</div>
                                <div class="function-item-params">(user_data_dir, api_key)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-1')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\auth\auth.py</span>
                            </div>
                            <div>
                                <span class="file-count">11</span>
                                <span class="expand-icon" id="folder-0-file-1-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-1-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, config_path, audit_log_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_check_rate_limit</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_create_default_config</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_record_login_attempt</div>
                                <div class="function-item-params">(self, username, success)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_save_config</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">check_session_timeout</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_user_session</div>
                                <div class="function-item-params">(self, username, user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">logout</div>
                                <div class="function-item-params">(self, skip_audit_log)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">register_user</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">reset_password</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_user_session</div>
                                <div class="function-item-params">(self, username, session_data, user_data_dir)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-2')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\auth\security.py</span>
                            </div>
                            <div>
                                <span class="file-count">17</span>
                                <span class="expand-icon" id="folder-0-file-2-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-2-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, timeout_minutes)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_detect_image_type</div>
                                <div class="function-item-params">(file_bytes)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">check_timeout</div>
                                <div class="function-item-params">(self, username, audit_logger)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_file_upload</div>
                                <div class="function-item-params">(self, username, filename, file_type, size)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_login_attempt</div>
                                <div class="function-item-params">(self, username, success, ip)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_logout</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_password_change</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_registration</div>
                                <div class="function-item-params">(self, username, email)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_security_event</div>
                                <div class="function-item-params">(self, event_type, username, details)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log_session_timeout</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">sanitize_dataframe_for_display</div>
                                <div class="function-item-params">(df)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">sanitize_html</div>
                                <div class="function-item-params">(text)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">set_secure_file_permissions</div>
                                <div class="function-item-params">(file_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">setup_audit_logger</div>
                                <div class="function-item-params">(log_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">update_activity</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">validate_csv_file</div>
                                <div class="function-item-params">(uploaded_file, max_size_mb)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">validate_image_file</div>
                                <div class="function-item-params">(uploaded_file, max_size_mb)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-3')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\data\color_similarity.py</span>
                            </div>
                            <div>
                                <span class="file-count">8</span>
                                <span class="expand-icon" id="folder-0-file-3-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-3-content">
            
                            <div class="function-item">
                                <div class="function-item-name">build_color_similarity_matrix</div>
                                <div class="function-item-params">(colors_df)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">calculate_color_distance</div>
                                <div class="function-item-params">(color1_rgb, color2_rgb, is_trans1, is_trans2)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">f</div>
                                <div class="function-item-params">(t)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">find_alternative_colors_for_parts</div>
                                <div class="function-item-params">(parts_df, collection_df, similarity_matrix, max_distance)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_similar_colors</div>
                                <div class="function-item-params">(color_id, similarity_matrix, max_distance)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_color_similarity_slider</div>
                                <div class="function-item-params">(location, loc_parts_df, collection_df, color_similarity_matrix)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">rgb_to_lab</div>
                                <div class="function-item-params">(rgb_hex)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">to_linear</div>
                                <div class="function-item-params">(c)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-4')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\data\colors.py</span>
                            </div>
                            <div>
                                <span class="file-count">3</span>
                                <span class="expand-icon" id="folder-0-file-4-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-4-content">
            
                            <div class="function-item">
                                <div class="function-item-name">build_color_lookup</div>
                                <div class="function-item-params">(colors_df)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_colors</div>
                                <div class="function-item-params">(colors_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_color_cell</div>
                                <div class="function-item-params">(color_id, color_lookup)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-5')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\data\preprocess.py</span>
                            </div>
                            <div>
                                <span class="file-count">6</span>
                                <span class="expand-icon" id="folder-0-file-5-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-5-content">
            
                            <div class="function-item">
                                <div class="function-item-name">get_collection_parts_set</div>
                                <div class="function-item-params">(collection_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_collection_parts_tuple</div>
                                <div class="function-item-params">(collection_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_collection_files</div>
                                <div class="function-item-params">(files)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_wanted_files</div>
                                <div class="function-item-params">(files)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">merge_wanted_collection</div>
                                <div class="function-item-params">(wanted, collection, rb_to_similar_mapping)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">sanitize_and_validate</div>
                                <div class="function-item-params">(df, required, label)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-6')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\data\sets.py</span>
                            </div>
                            <div>
                                <span class="file-count">16</span>
                                <span class="expand-icon" id="folder-0-file-6-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-6-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, user_data_dir, global_cache_dir, api_key)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_parse_bool</div>
                                <div class="function-item-params">(self, value)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">add_manual_set</div>
                                <div class="function-item-params">(self, set_number)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">delete_set</div>
                                <div class="function-item-params">(self, set_number)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">delete_source_group</div>
                                <div class="function-item-params">(self, source_name)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_all_inventories</div>
                                <div class="function-item-params">(self, api_client, progress_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_inventory</div>
                                <div class="function-item-params">(self, set_number, api_client)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_sets_by_source</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_all_inventories</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_into_session_state</div>
                                <div class="function-item-params">(self, session_state)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_inventory</div>
                                <div class="function-item-params">(self, set_number)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_sets_from_csv</div>
                                <div class="function-item-params">(self, csv_file, source_name)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_sets_metadata</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_sets_metadata</div>
                                <div class="function-item-params">(self, sets)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_to_session_state</div>
                                <div class="function-item-params">(self, session_state)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">search_parts</div>
                                <div class="function-item-params">(self, part_color_pairs, selected_sets, inventories_cache)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-7')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\external\download_helpers.py</span>
                            </div>
                            <div>
                                <span class="file-count">5</span>
                                <span class="expand-icon" id="folder-0-file-7-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-7-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, stop_flag_key, show_stats, stats_formatter)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">create_download_callbacks</div>
                                <div class="function-item-params">(stop_flag_key, show_stats, stats_formatter)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">progress_callback</div>
                                <div class="function-item-params">(self, message, status)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">stats_callback</div>
                                <div class="function-item-params">(self, stats)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">stop_flag_callback</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-8')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\external\rebrickable_api.py</span>
                            </div>
                            <div>
                                <span class="file-count">7</span>
                                <span class="expand-icon" id="folder-0-file-8-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-8-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, api_key, timeout)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_handle_response</div>
                                <div class="function-item-params">(self, response)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_rate_limit</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_part_info</div>
                                <div class="function-item-params">(self, part_num)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_set_info</div>
                                <div class="function-item-params">(self, set_number)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_set_parts</div>
                                <div class="function-item-params">(self, set_number, include_spares)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">validate_key</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-9')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\infrastructure\paths.py</span>
                            </div>
                            <div>
                                <span class="file-count">7</span>
                                <span class="expand-icon" id="folder-0-file-9-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-9-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_user_collection_parts_dir</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_user_collection_sets_dir</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_user_uploaded_images_dir</div>
                                <div class="function-item-params">(self, username)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">init_paths</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">manage_default_collection</div>
                                <div class="function-item-params">(user_collection_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_uploadedfiles</div>
                                <div class="function-item-params">(uploadedfiles_list, user_collection_dir)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-10')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\infrastructure\session.py</span>
                            </div>
                            <div>
                                <span class="file-count">2</span>
                                <span class="expand-icon" id="folder-0-file-10-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-10-content">
            
                            <div class="function-item">
                                <div class="function-item-name">ensure_session_state_keys</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">short_key</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-11')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\labels\labels.py</span>
                            </div>
                            <div>
                                <span class="file-count">2</span>
                                <span class="expand-icon" id="folder-0-file-11-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-11-content">
            
                            <div class="function-item">
                                <div class="function-item-name">generate_collection_labels_zip</div>
                                <div class="function-item-params">(collection_files_stream, ba_mapping, labels_source_dir, output_mode, progress_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">organize_labels_by_location</div>
                                <div class="function-item-params">(collection_df, ba_mapping, labels_source_dir, output_mode, progress_callback)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-12')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\labels\lbx_merger.py</span>
                            </div>
                            <div>
                                <span class="file-count">15</span>
                                <span class="expand-icon" id="folder-0-file-12-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-12-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, max_length_mm, spacing_mm)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">calculate_label_bounds</div>
                                <div class="function-item-params">(self, objects, resize_text)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">create_merged_label_xml</div>
                                <div class="function-item-params">(self, label_contents)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">extract_label_content_zip</div>
                                <div class="function-item-params">(self, filepath)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_label_content_width_mm</div>
                                <div class="function-item-params">(self, label_xml)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_label_content_width_pt</div>
                                <div class="function-item-params">(self, label_xml)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_label_objects</div>
                                <div class="function-item-params">(self, root)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_paper_element</div>
                                <div class="function-item-params">(self, root)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_text_visual_width</div>
                                <div class="function-item-params">(self, text_elem)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">main</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">merge_labels</div>
                                <div class="function-item-params">(self, input_files, output_file)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">merge_properties_xml</div>
                                <div class="function-item-params">(self, label_contents)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">merge_zip_based_labels</div>
                                <div class="function-item-params">(self, label_contents, output_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">parse_label_xml</div>
                                <div class="function-item-params">(self, xml)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">shift_object_positions</div>
                                <div class="function-item-params">(self, obj, x_offset, y_offset)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-13')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\parts\custom_mapping.py</span>
                            </div>
                            <div>
                                <span class="file-count">6</span>
                                <span class="expand-icon" id="folder-0-file-13-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-13-content">
            
                            <div class="function-item">
                                <div class="function-item-name">apply_custom_mapping</div>
                                <div class="function-item-params">(rb_part, custom_mapping)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">build_custom_mapping_dict</div>
                                <div class="function-item-params">(df)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">create_default_custom_mapping_csv</div>
                                <div class="function-item-params">(csv_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_custom_mapping_csv</div>
                                <div class="function-item-params">(csv_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">match_wildcard_pattern</div>
                                <div class="function-item-params">(rb_part, pattern)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_custom_mapping_csv</div>
                                <div class="function-item-params">(df, csv_path)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-14')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\parts\images.py</span>
                            </div>
                            <div>
                                <span class="file-count">15</span>
                                <span class="expand-icon" id="folder-0-file-14-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-14-content">
            
                            <div class="function-item">
                                <div class="function-item-name">_fetch_single_image</div>
                                <div class="function-item-params">(identifier, cache_dir, session, cache_rb_dir, api_key, unavailable_images, rb_part_num)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_get_unavailable_images_file</div>
                                <div class="function-item-params">(user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_load_unavailable_images</div>
                                <div class="function-item-params">(user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">_save_unavailable_images</div>
                                <div class="function-item-params">(unavailable_images, user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">clear_unavailable_images_cache</div>
                                <div class="function-item-params">(user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">count_custom_images</div>
                                <div class="function-item-params">(user_uploaded_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">create_custom_images_zip</div>
                                <div class="function-item-params">(user_uploaded_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">delete_all_custom_images</div>
                                <div class="function-item-params">(user_uploaded_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_image_bytes</div>
                                <div class="function-item-params">(url, _session)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_wanted_part_images</div>
                                <div class="function-item-params">(merged_df_serialized, ba_mapping, cache_images_dir, user_uploaded_dir, cache_rb_dir, api_key, user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_cached_images_batch</div>
                                <div class="function-item-params">(part_ids, cache_dir, max_workers, user_uploaded_dir, progress_callback, cache_rb_dir, api_key, user_data_dir, ba_to_rb_map)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_unavailable_images_count</div>
                                <div class="function-item-params">(user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">precompute_location_images</div>
                                <div class="function-item-params">(collection_df_serialized, ba_mapping, cache_images_dir, user_uploaded_dir, progress_callback, cache_rb_dir, api_key, user_data_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">save_user_uploaded_image</div>
                                <div class="function-item-params">(uploaded_file, part_num, user_uploaded_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">upload_custom_images</div>
                                <div class="function-item-params">(uploaded_files, user_uploaded_dir)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-15')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\parts\mapping.py</span>
                            </div>
                            <div>
                                <span class="file-count">9</span>
                                <span class="expand-icon" id="folder-0-file-15-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-15-content">
            
                            <div class="function-item">
                                <div class="function-item-name">__getitem__</div>
                                <div class="function-item-params">(self, key)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">__init__</div>
                                <div class="function-item-params">(self, base_mapping, custom_mapping)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">build_ba_to_rb_mapping</div>
                                <div class="function-item-params">(mapping_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">build_rb_to_similar_parts_mapping</div>
                                <div class="function-item-params">(mapping_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">count_parts_in_mapping</div>
                                <div class="function-item-params">(mapping_path_str, collection_parts, count_type)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get</div>
                                <div class="function-item-params">(self, key, default)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_ba_mapping</div>
                                <div class="function-item-params">(mapping_path, custom_mapping_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">load_ba_part_names</div>
                                <div class="function-item-params">(mapping_path)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">read_ba_mapping_from_excel_bytes</div>
                                <div class="function-item-params">(excel_bytes)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-16')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\state\find_wanted_parts.py</span>
                            </div>
                            <div>
                                <span class="file-count">9</span>
                                <span class="expand-icon" id="folder-0-file-16-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-16-content">
            
                            <div class="function-item">
                                <div class="function-item-name">get_unfound_parts</div>
                                <div class="function-item-params">(merged_df, color_lookup)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">merge_set_results</div>
                                <div class="function-item-params">(original_df, set_results)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_location_actions</div>
                                <div class="function-item-params">(location, loc_group)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_missing_parts_by_set</div>
                                <div class="function-item-params">(set_results, merged_df, part_images_map, ba_part_names, color_lookup)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_missing_parts_export</div>
                                <div class="function-item-params">(merged)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_part_detail</div>
                                <div class="function-item-params">(part_num, part_group, location, alternative_colors, color_lookup, user_uploaded_images_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_second_location_parts</div>
                                <div class="function-item-params">(location, second_loc_rows, color_lookup)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_set_search_section</div>
                                <div class="function-item-params">(merged_df, sets_manager, color_lookup)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">sync_checkbox_to_set</div>
                                <div class="function-item-params">(set_num)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-17')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>core\state\progress.py</span>
                            </div>
                            <div>
                                <span class="file-count">1</span>
                                <span class="expand-icon" id="folder-0-file-17-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-17-content">
            
                            <div class="function-item">
                                <div class="function-item-name">render_summary_table</div>
                                <div class="function-item-params">(merged_df, set_search_results, set_found_counts, color_lookup)</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-18')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>resources\ba_part_images.py</span>
                            </div>
                            <div>
                                <span class="file-count">4</span>
                                <span class="expand-icon" id="folder-0-file-18-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-18-content">
            
                            <div class="function-item">
                                <div class="function-item-name">download_ba_images</div>
                                <div class="function-item-params">(mapping_path, cache_images_dir, timeout, progress_callback, stop_flag_callback, stats_callback, filter_mode, collection_parts)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log</div>
                                <div class="function-item-params">(message, status)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">should_stop</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">update_stats</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-19')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>resources\ba_part_labels.py</span>
                            </div>
                            <div>
                                <span class="file-count">4</span>
                                <span class="expand-icon" id="folder-0-file-19-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-19-content">
            
                            <div class="function-item">
                                <div class="function-item-name">download_ba_labels</div>
                                <div class="function-item-params">(mapping_path, cache_labels_dir, timeout, progress_callback, stop_flag_callback, stats_callback, filter_mode, collection_parts)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log</div>
                                <div class="function-item-params">(message, status)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">should_stop</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">update_stats</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-20')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>resources\ba_part_mappings.py</span>
                            </div>
                            <div>
                                <span class="file-count">10</span>
                                <span class="expand-icon" id="folder-0-file-20-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-20-content">
            
                            <div class="function-item">
                                <div class="function-item-name">display_mapping_files_info</div>
                                <div class="function-item-params">(resources_dir, count_parts_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_all_ba_parts</div>
                                <div class="function-item-params">(output_file, start_page, log_callback, stop_flag_callback, stats_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_ba_parts_from_page</div>
                                <div class="function-item-params">(page, output_file, log_callback, stop_flag_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">fetch_rebrickable_mappings</div>
                                <div class="function-item-params">(output_file, checkpoint_interval, log_callback, stop_flag_callback, stats_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">find_latest_mapping_file</div>
                                <div class="function-item-params">(resources_dir)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">get_rebrickable_parts</div>
                                <div class="function-item-params">(ba_part_number, log_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">log</div>
                                <div class="function-item-params">(message, status)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">should_stop</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">update_ba_mappings</div>
                                <div class="function-item-params">(output_file, log_callback, stop_flag_callback, stats_callback)</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">update_stats</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-21')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>ui\shared_content.py</span>
                            </div>
                            <div>
                                <span class="file-count">3</span>
                                <span class="expand-icon" id="folder-0-file-21-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-21-content">
            
                            <div class="function-item">
                                <div class="function-item-name">render_about_info_content</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_app_features_content</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                            <div class="function-item">
                                <div class="function-item-name">render_new_user_content</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                        </div>
                    </div>
            
                    <div class="file-section">
                        <div class="file-header" onclick="toggleFile('folder-0-file-22')">
                            <div>
                                <span class="file-icon">üìÑ</span>
                                <span>ui\theme.py</span>
                            </div>
                            <div>
                                <span class="file-count">1</span>
                                <span class="expand-icon" id="folder-0-file-22-icon">‚ñ∂</span>
                            </div>
                        </div>
                        <div class="functions-container" id="folder-0-file-22-content">
            
                            <div class="function-item">
                                <div class="function-item-name">apply_custom_styles</div>
                                <div class="function-item-params">()</div>
                            </div>
                
                        </div>
                    </div>
            
                </div>
            </div>
        
        </div>
        
        <div id="flow" class="tab-content">
            <h2>Application Flow Diagram</h2>
            <pre>================================================================================
APPLICATION EXECUTION FLOW
================================================================================

‚îå‚îÄ app.py (Main Entry Point)
‚îÇ
‚îú‚îÄ‚î¨‚îÄ CORE MODULES
‚îÇ ‚îú‚îÄ core/auth/
‚îÇ     ‚îú‚îÄ api_keys.py
‚îÇ    ‚îÇ    ‚îî‚îÄ save_api_key(user_data_dir, api_key)
‚îÇ    ‚îÇ    ‚îî‚îÄ load_api_key(user_data_dir)
‚îÇ    ‚îÇ    ‚îî‚îÄ delete_api_key(user_data_dir)
‚îÇ     ‚îú‚îÄ auth.py
‚îÇ    ‚îÇ    ‚îî‚îÄ __init__(self, config_path, audit_log_dir)
‚îÇ    ‚îÇ    ‚îî‚îÄ _create_default_config(self)
‚îÇ    ‚îÇ    ‚îî‚îÄ check_session_timeout(self, username)
‚îÇ     ‚îî‚îÄ security.py
‚îÇ         ‚îî‚îÄ _detect_image_type(file_bytes)
‚îÇ         ‚îî‚îÄ setup_audit_logger(log_dir)
‚îÇ         ‚îî‚îÄ sanitize_html(text)
‚îÇ ‚îú‚îÄ core/data/
‚îÇ     ‚îú‚îÄ color_similarity.py
‚îÇ    ‚îÇ    ‚îî‚îÄ rgb_to_lab(rgb_hex)
‚îÇ    ‚îÇ    ‚îî‚îÄ calculate_color_distance(color1_rgb, color2_rgb, is_trans1, ...)
‚îÇ    ‚îÇ    ‚îî‚îÄ build_color_similarity_matrix(colors_df)
‚îÇ     ‚îú‚îÄ colors.py
‚îÇ    ‚îÇ    ‚îî‚îÄ load_colors(colors_path)
‚îÇ    ‚îÇ    ‚îî‚îÄ build_color_lookup(colors_df)
‚îÇ    ‚îÇ    ‚îî‚îÄ render_color_cell(color_id, color_lookup)
‚îÇ     ‚îú‚îÄ preprocess.py
‚îÇ    ‚îÇ    ‚îî‚îÄ sanitize_and_validate(df, required, label)
‚îÇ    ‚îÇ    ‚îî‚îÄ load_wanted_files(files)
‚îÇ    ‚îÇ    ‚îî‚îÄ load_collection_files(files)
‚îÇ     ‚îî‚îÄ sets.py
‚îÇ         ‚îî‚îÄ __init__(self, user_data_dir, global_cache_dir, ...)
‚îÇ         ‚îî‚îÄ load_sets_from_csv(self, csv_file, source_name)
‚îÇ         ‚îî‚îÄ _parse_bool(self, value)
‚îÇ ‚îú‚îÄ core/external/
‚îÇ     ‚îú‚îÄ download_helpers.py
‚îÇ    ‚îÇ    ‚îî‚îÄ create_download_callbacks(stop_flag_key, show_stats, stats_formatter)
‚îÇ    ‚îÇ    ‚îî‚îÄ __init__(self, stop_flag_key, show_stats, ...)
‚îÇ    ‚îÇ    ‚îî‚îÄ progress_callback(self, message, status)
‚îÇ     ‚îî‚îÄ rebrickable_api.py
‚îÇ         ‚îî‚îÄ __init__(self, api_key, timeout)
‚îÇ         ‚îî‚îÄ validate_key(self)
‚îÇ         ‚îî‚îÄ get_set_parts(self, set_number, include_spares)
‚îÇ ‚îú‚îÄ core/infrastructure/
‚îÇ     ‚îú‚îÄ paths.py
‚îÇ    ‚îÇ    ‚îî‚îÄ init_paths()
‚îÇ    ‚îÇ    ‚îî‚îÄ save_uploadedfiles(uploadedfiles_list, user_collection_dir)
‚îÇ    ‚îÇ    ‚îî‚îÄ manage_default_collection(user_collection_dir)
‚îÇ     ‚îî‚îÄ session.py
‚îÇ         ‚îî‚îÄ ensure_session_state_keys()
‚îÇ         ‚îî‚îÄ short_key()
‚îÇ ‚îú‚îÄ core/labels/
‚îÇ     ‚îú‚îÄ labels.py
‚îÇ    ‚îÇ    ‚îî‚îÄ organize_labels_by_location(collection_df, ba_mapping, labels_source_dir, ...)
‚îÇ    ‚îÇ    ‚îî‚îÄ generate_collection_labels_zip(collection_files_stream, ba_mapping, labels_source_dir, ...)
‚îÇ     ‚îî‚îÄ lbx_merger.py
‚îÇ         ‚îî‚îÄ main()
‚îÇ         ‚îî‚îÄ __init__(self, max_length_mm, spacing_mm)
‚îÇ         ‚îî‚îÄ parse_label_xml(self, xml)
‚îÇ ‚îú‚îÄ core/parts/
‚îÇ     ‚îú‚îÄ custom_mapping.py
‚îÇ    ‚îÇ    ‚îî‚îÄ create_default_custom_mapping_csv(csv_path)
‚îÇ    ‚îÇ    ‚îî‚îÄ load_custom_mapping_csv(csv_path)
‚îÇ    ‚îÇ    ‚îî‚îÄ save_custom_mapping_csv(df, csv_path)
‚îÇ     ‚îú‚îÄ images.py
‚îÇ    ‚îÇ    ‚îî‚îÄ _get_unavailable_images_file(user_data_dir)
‚îÇ    ‚îÇ    ‚îî‚îÄ _load_unavailable_images(user_data_dir)
‚îÇ    ‚îÇ    ‚îî‚îÄ _save_unavailable_images(unavailable_images, user_data_dir)
‚îÇ     ‚îî‚îÄ mapping.py
‚îÇ         ‚îî‚îÄ read_ba_mapping_from_excel_bytes(excel_bytes)
‚îÇ         ‚îî‚îÄ load_ba_part_names(mapping_path)
‚îÇ         ‚îî‚îÄ load_ba_mapping(mapping_path, custom_mapping_path)
‚îÇ ‚îî‚îÄ core/state/
      ‚îú‚îÄ find_wanted_parts.py
     ‚îÇ    ‚îî‚îÄ get_unfound_parts(merged_df, color_lookup)
     ‚îÇ    ‚îî‚îÄ merge_set_results(original_df, set_results)
     ‚îÇ    ‚îî‚îÄ render_missing_parts_by_set(set_results, merged_df, part_images_map, ...)
      ‚îî‚îÄ progress.py
          ‚îî‚îÄ render_summary_table(merged_df, set_search_results, set_found_counts, ...)
‚îÇ
‚îú‚îÄ‚î¨‚îÄ UI MODULES
‚îÇ ‚îú‚îÄ ui/shared_content.py
‚îÇ     ‚îî‚îÄ render_about_info_content()
‚îÇ     ‚îî‚îÄ render_app_features_content()
‚îÇ     ‚îî‚îÄ render_new_user_content()
‚îÇ ‚îî‚îÄ ui/theme.py
      ‚îî‚îÄ apply_custom_styles()
‚îÇ
‚îú‚îÄ‚î¨‚îÄ PAGES
‚îÇ ‚îú‚îÄ pages/1_Rebrickable_Storage.py
‚îÇ     ‚îî‚îÄ 90 lines of code
‚îÇ ‚îú‚îÄ pages/2_My_Collection_Parts.py
‚îÇ     ‚îî‚îÄ 697 lines of code
‚îÇ ‚îú‚îÄ pages/3_My_Collection_Sets.py
‚îÇ     ‚îî‚îÄ 403 lines of code
‚îÇ ‚îî‚îÄ pages/4_Find_Wanted_Parts.py
      ‚îî‚îÄ 351 lines of code
‚îÇ
‚îî‚îÄ‚î¨‚îÄ RESOURCES
  ‚îú‚îÄ auth_config.yaml (User credentials)
  ‚îú‚îÄ colors.csv (LEGO color database)
  ‚îî‚îÄ part number mapping.xlsx (BA ‚Üî RB)

================================================================================
USER EXPERIENCE FLOW
================================================================================

‚îå‚îÄ 1. LOGIN
‚îÇ  ‚îú‚îÄ User enters credentials
‚îÇ  ‚îú‚îÄ AuthManager.login() validates
‚îÇ  ‚îú‚îÄ Session initialized
‚îÇ  ‚îî‚îÄ Redirect to main app
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 2. UPLOAD WANTED PARTS
‚îÇ  ‚îú‚îÄ File uploader widget
‚îÇ  ‚îú‚îÄ CSV validation
‚îÇ  ‚îú‚îÄ Store in session_state['wanted_df']
‚îÇ  ‚îî‚îÄ Display preview
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 3. SELECT COLLECTION
‚îÇ  ‚îú‚îÄ List available collection files
‚îÇ  ‚îú‚îÄ User selects files
‚îÇ  ‚îú‚îÄ Load CSVs into session_state['collection_df']
‚îÇ  ‚îî‚îÄ Merge collections
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 4. PROCESS & MATCH
‚îÇ  ‚îú‚îÄ preprocess.merge_wanted_collection()
‚îÇ  ‚îú‚îÄ mapping.apply_part_mappings()
‚îÇ  ‚îú‚îÄ images.fetch_images()
‚îÇ  ‚îú‚îÄ colors.add_color_data()
‚îÇ  ‚îî‚îÄ Group by location
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 5. BROWSE LOCATIONS
‚îÇ  ‚îú‚îÄ Display location cards
‚îÇ  ‚îú‚îÄ Show part images
‚îÇ  ‚îú‚îÄ Display quantities needed/available
‚îÇ  ‚îî‚îÄ Expandable details
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 6. MARK FOUND PARTS
‚îÇ  ‚îú‚îÄ User clicks 'Found' button
‚îÇ  ‚îú‚îÄ Update session_state['found_counts']
‚îÇ  ‚îú‚îÄ Recalculate remaining
‚îÇ  ‚îî‚îÄ Visual feedback
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 7. EXPORT RESULTS
‚îÇ  ‚îú‚îÄ Download merged CSV
‚îÇ  ‚îú‚îÄ Generate location labels
‚îÇ  ‚îú‚îÄ Create LBX file
‚îÇ  ‚îî‚îÄ Save session progress
‚îÇ

================================================================================
MULTI-PAGE NAVIGATION STRUCTURE
================================================================================

‚îå‚îÄ app.py (Main Entry Point)
‚îÇ
‚îú‚îÄ Authentication & Setup
‚îÇ  ‚îú‚îÄ Login/Register
‚îÇ  ‚îú‚îÄ Session State Initialization
‚îÇ  ‚îî‚îÄ Path Resolution
‚îÇ
‚îú‚îÄ Sidebar Features (Global)
‚îÇ  ‚îú‚îÄ User Profile & Logout
‚îÇ  ‚îú‚îÄ Get Latest Labels/Images from BrickArchitect
‚îÇ  ‚îî‚îÄ Sync Latest Parts Mappings
‚îÇ
‚îî‚îÄ‚î¨‚îÄ MULTI-PAGE NAVIGATION
  ‚îÇ
  ‚îú‚îÄ 1_Rebrickable_Storage
  ‚îÇ    ‚îî‚îÄ 1_Rebrickable_Storage
  ‚îÇ       ‚îú‚îÄ 90 lines of code
  ‚îÇ       ‚îú‚îÄ 1 core module imports
  ‚îÇ       ‚îî‚îÄ 5 UI elements
  ‚îú‚îÄ 2_My_Collection_Parts
  ‚îÇ    ‚îî‚îÄ üè∑Ô∏è My Collection - Parts
  ‚îÇ       ‚îú‚îÄ 697 lines of code
  ‚îÇ       ‚îú‚îÄ 15 core module imports
  ‚îÇ       ‚îî‚îÄ 46 UI elements
  ‚îú‚îÄ 3_My_Collection_Sets
  ‚îÇ    ‚îî‚îÄ üì¶ My Collection - Sets
  ‚îÇ       ‚îú‚îÄ 403 lines of code
  ‚îÇ       ‚îú‚îÄ 4 core module imports
  ‚îÇ       ‚îî‚îÄ 30 UI elements
  ‚îî‚îÄ 4_Find_Wanted_Parts
       ‚îî‚îÄ üîç Find Wanted Parts
          ‚îú‚îÄ 351 lines of code
          ‚îú‚îÄ 12 core module imports
          ‚îî‚îÄ 12 UI elements

================================================================================
PAGE NAVIGATION FLOW
================================================================================

‚îå‚îÄ 1. Landing Page (app.py)
‚îÇ  ‚îú‚îÄ User logs in or registers
‚îÇ  ‚îú‚îÄ Sees welcome screen with navigation options
‚îÇ  ‚îî‚îÄ Session state initialized, sets data loaded
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 2. Rebrickable Storage (1_Rebrickable_Storage.py)
‚îÇ  ‚îú‚îÄ Main dashboard and getting started page
‚îÇ  ‚îú‚îÄ Overview of available functions
‚îÇ  ‚îî‚îÄ Navigation to other pages
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 3. My Collection - Parts (2_My_Collection_Parts.py)
‚îÇ  ‚îú‚îÄ Manage collection files (upload, select, delete)
‚îÇ  ‚îú‚îÄ Generate printable labels by location (LBX + merged)
‚îÇ  ‚îú‚îÄ Manage custom part images (upload, export, delete)
‚îÇ  ‚îú‚îÄ Sync BrickArchitect labels and images
‚îÇ  ‚îî‚îÄ View collection statistics
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 4. My Collection - Sets (3_My_Collection_Sets.py)
‚îÇ  ‚îú‚îÄ Upload sets CSV or add manually
‚îÇ  ‚îú‚îÄ Configure Rebrickable API key
‚îÇ  ‚îú‚îÄ Retrieve part inventories (single or batch)
‚îÇ  ‚îú‚îÄ Delete sets or source groups
‚îÇ  ‚îî‚îÄ View sets grouped by source
‚îÇ
‚ñº
‚îÇ
‚îå‚îÄ 5. Find Wanted Parts (4_Find_Wanted_Parts.py)
‚îÇ  ‚îú‚îÄ Upload wanted parts lists
‚îÇ  ‚îú‚îÄ Select collection files to search
‚îÇ  ‚îú‚îÄ Generate pickup list by location
‚îÇ  ‚îú‚îÄ Search owned sets for missing parts
‚îÇ  ‚îú‚îÄ Mark parts as found (per-location mark all/clear)
‚îÇ  ‚îú‚îÄ View color alternatives
‚îÇ  ‚îú‚îÄ View progress summary table
‚îÇ  ‚îú‚îÄ Save/load progress
‚îÇ  ‚îî‚îÄ Download merged results or missing parts export
‚îÇ

================================================================================
FUNCTION DISTRIBUTION ANALYSIS
================================================================================

‚îå‚îÄ FUNCTION DISTRIBUTION BY MODULE TYPE
‚îÇ
‚îÇ  Core Modules:      0 functions
‚îÇ  UI Modules:        0 functions
‚îÇ  Resource Modules:  0 functions
‚îÇ  Main App:          0 functions
‚îÇ
‚îú‚îÄ PAGE COMPLEXITY METRICS
‚îÇ
‚îÇ  ‚îú‚îÄ 1_Rebrickable_Storage
‚îÇ  ‚îÇ     ‚îú‚îÄ 90 lines of code
‚îÇ  ‚îÇ     ‚îú‚îÄ 1 core module imports
‚îÇ  ‚îÇ     ‚îî‚îÄ 5 UI elements
‚îÇ  ‚îú‚îÄ 2_My_Collection_Parts
‚îÇ  ‚îÇ     ‚îú‚îÄ 697 lines of code
‚îÇ  ‚îÇ     ‚îú‚îÄ 15 core module imports
‚îÇ  ‚îÇ     ‚îî‚îÄ 46 UI elements
‚îÇ  ‚îú‚îÄ 3_My_Collection_Sets
‚îÇ  ‚îÇ     ‚îú‚îÄ 403 lines of code
‚îÇ  ‚îÇ     ‚îú‚îÄ 4 core module imports
‚îÇ  ‚îÇ     ‚îî‚îÄ 30 UI elements
‚îÇ  ‚îî‚îÄ 4_Find_Wanted_Parts
‚îÇ        ‚îú‚îÄ 351 lines of code
‚îÇ        ‚îú‚îÄ 12 core module imports
‚îÇ        ‚îî‚îÄ 12 UI elements
‚îÇ
‚îî‚îÄ ARCHITECTURE PATTERN

   The application follows a modular architecture:
   ‚îú‚îÄ Core modules contain business logic (reusable)
   ‚îú‚îÄ UI modules contain presentation helpers (reusable)
   ‚îú‚îÄ Pages contain page-specific UI logic (minimal functions)
   ‚îî‚îÄ Main app handles authentication and global setup

   This separation ensures:
   ‚Ä¢ Business logic is testable and reusable
   ‚Ä¢ Pages remain focused on user interaction
   ‚Ä¢ Code is maintainable and scalable

================================================================================
DATA STRUCTURES & DIMENSIONS
================================================================================

‚îå‚îÄ SESSION STATE (st.session_state)
‚îÇ
‚îÇ  ‚îú‚îÄ wanted_df: DataFrame
‚îÇ  ‚îÇ     ‚îî‚îÄ Wanted parts list
‚îÇ  ‚îÇ        ‚îî‚îÄ Columns: Part, Color, Quantity, Location
‚îÇ  ‚îú‚îÄ collection_df: DataFrame
‚îÇ  ‚îÇ     ‚îî‚îÄ User's collection
‚îÇ  ‚îÇ        ‚îî‚îÄ Columns: Part, Color, Quantity, Location
‚îÇ  ‚îú‚îÄ merged_df: DataFrame
‚îÇ  ‚îÇ     ‚îî‚îÄ Matched parts
‚îÇ  ‚îÇ        ‚îî‚îÄ wanted_df + collection_df merged
‚îÇ  ‚îú‚îÄ found_counts: Dict
‚îÇ  ‚îÇ     ‚îî‚îÄ Tracking found parts
‚îÇ  ‚îÇ        ‚îî‚îÄ {(part, color, location): count}
‚îÇ  ‚îú‚îÄ locations_index: Dict
‚îÇ  ‚îÇ     ‚îî‚îÄ Location grouping
‚îÇ  ‚îÇ        ‚îî‚îÄ {location: [image_urls]}
‚îÇ  ‚îú‚îÄ expanded_loc: str
‚îÇ  ‚îÇ     ‚îî‚îÄ UI state
‚îÇ  ‚îÇ        ‚îî‚îÄ Currently expanded location
‚îÇ  ‚îú‚îÄ start_processing: bool
‚îÇ  ‚îÇ     ‚îî‚îÄ Trigger flag
‚îÇ  ‚îÇ        ‚îî‚îÄ Initiates processing
‚îÇ  ‚îî‚îÄ theme: str
‚îÇ        ‚îî‚îÄ UI preference
‚îÇ           ‚îî‚îÄ 'dark' or 'light'
‚îÇ
‚îú‚îÄ DATAFRAMES
‚îÇ
‚îÇ  ‚îú‚îÄ wanted_df
‚îÇ  ‚îÇ     ‚îú‚îÄ Part Number (str)
‚îÇ  ‚îÇ     ‚îú‚îÄ Color (str)
‚îÇ  ‚îÇ     ‚îú‚îÄ Quantity Needed (int)
‚îÇ  ‚îÇ     ‚îî‚îÄ Location (str, optional)
‚îÇ  ‚îú‚îÄ collection_df
‚îÇ  ‚îÇ     ‚îú‚îÄ Part Number (str)
‚îÇ  ‚îÇ     ‚îú‚îÄ Color (str)
‚îÇ  ‚îÇ     ‚îú‚îÄ Quantity Available (int)
‚îÇ  ‚îÇ     ‚îî‚îÄ Location (str)
‚îÇ  ‚îî‚îÄ merged_df
‚îÇ        ‚îú‚îÄ Part Number (str)
‚îÇ        ‚îú‚îÄ Color (str)
‚îÇ        ‚îú‚îÄ Quantity Needed (int)
‚îÇ        ‚îú‚îÄ Quantity Available (int)
‚îÇ        ‚îú‚îÄ Location (str)
‚îÇ        ‚îú‚îÄ Image URL (str)
‚îÇ        ‚îú‚îÄ Color Name (str)
‚îÇ        ‚îî‚îÄ Color RGB (str)
‚îÇ
‚îî‚îÄ FILE SYSTEM

   ‚îú‚îÄ user_data/{username}/
   ‚îÇ     ‚îú‚îÄ collection/*.csv - User's collection files
   ‚îÇ     ‚îî‚îÄ session_data.json - Saved progress
   ‚îú‚îÄ cache/
   ‚îÇ     ‚îú‚îÄ images/*.png - Cached part images
   ‚îÇ     ‚îî‚îÄ labels/*.png - Generated label images
   ‚îî‚îÄ resources/
         ‚îú‚îÄ auth_config.yaml - User credentials (hashed)
         ‚îú‚îÄ colors.csv - LEGO color database (~200 colors)
         ‚îî‚îÄ part number mapping.xlsx - BA‚ÜîRB mappings (~2000 parts)

================================================================================
MODULE DEPENDENCIES
================================================================================

app.py
‚îÇ
‚îú‚îÄ auth
‚îÇ    ‚îî‚îÄ ‚Üí core.auth.security
‚îú‚îÄ find_wanted_parts
‚îÇ    ‚îú‚îÄ ‚Üí core.data.colors
‚îÇ    ‚îú‚îÄ ‚Üí core.infrastructure.session
‚îÇ    ‚îî‚îÄ ‚Üí core.parts.images
‚îú‚îÄ images
‚îÇ    ‚îú‚îÄ ‚Üí core.auth.security
‚îÇ    ‚îú‚îÄ ‚Üí core.external.rebrickable_api
‚îÇ    ‚îî‚îÄ ‚Üí core.security.validate_image_file
‚îú‚îÄ labels
‚îÇ    ‚îú‚îÄ ‚Üí core.data.preprocess
‚îÇ    ‚îî‚îÄ ‚Üí core.labels.lbx_merger
‚îú‚îÄ mapping
‚îÇ    ‚îî‚îÄ ‚Üí core.parts.custom_mapping
‚îî‚îÄ sets
     ‚îî‚îÄ ‚Üí core.external.rebrickable_api

================================================================================
ARCHITECTURE OVERVIEW
================================================================================

‚îå‚îÄ TECHNOLOGY STACK
‚îÇ
‚îÇ  Frontend
‚îÇ  ‚îî‚îÄ Streamlit (Web UI Framework)
‚îÇ
‚îÇ  Authentication
‚îÇ  ‚îú‚îÄ streamlit-authenticator (Auth library)
‚îÇ  ‚îú‚îÄ bcrypt (Password hashing)
‚îÇ  ‚îî‚îÄ PyYAML (Config management)
‚îÇ
‚îÇ  Data Processing
‚îÇ  ‚îú‚îÄ pandas (Data manipulation)
‚îÇ  ‚îî‚îÄ requests (HTTP client)
‚îÇ
‚îÇ  Storage
‚îÇ  ‚îú‚îÄ Local filesystem (Development)
‚îÇ  ‚îî‚îÄ JSON (Session serialization)
‚îÇ
‚îú‚îÄ SESSION STATE MANAGEMENT
‚îÇ
‚îÇ  Global (Shared)
‚îÇ  ‚îú‚îÄ ba_mapping - Part number mappings
‚îÇ  ‚îú‚îÄ color_lookup - Color database
‚îÇ  ‚îî‚îÄ theme - UI theme preference
‚îÇ
‚îÇ  User-Specific (Isolated)
‚îÇ  ‚îú‚îÄ username - Current user
‚îÇ  ‚îú‚îÄ authenticated - Auth status
‚îÇ  ‚îú‚îÄ collection_df - User's collection
‚îÇ  ‚îú‚îÄ found_counts - Parts marked as found
‚îÇ  ‚îú‚îÄ locations_index - Location grouping
‚îÇ  ‚îú‚îÄ merged_df - Matched parts
‚îÇ  ‚îú‚îÄ sets_metadata - Sets collection data
‚îÇ  ‚îú‚îÄ sets_inventories_cache - Cached inventories
‚îÇ  ‚îú‚îÄ set_search_results - Set search results
‚îÇ  ‚îî‚îÄ set_found_counts - Set-based found counts
‚îÇ
‚îú‚îÄ EXTERNAL INTEGRATIONS
‚îÇ
‚îÇ  ‚îå‚îÄ Rebrickable API
‚îÇ  ‚îÇ  ‚îî‚îÄ Part data and mappings
‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ BrickArchitect Images
‚îÇ     ‚îî‚îÄ Part images (cached locally)
‚îÇ
‚îî‚îÄ DEPLOYMENT

   Development:
   ‚îú‚îÄ localhost:8501
   ‚îú‚îÄ File-based storage
   ‚îú‚îÄ Local user_data/
   ‚îî‚îÄ YAML configuration

   Production (Recommended):
   ‚îú‚îÄ HTTPS with SSL/TLS
   ‚îú‚îÄ Database backend (PostgreSQL/MongoDB)
   ‚îú‚îÄ Cloud storage (S3/Azure Blob)
   ‚îî‚îÄ Environment secrets management

================================================================================
RUNTIME METRICS & DATA DIMENSIONS
================================================================================

‚îå‚îÄ RESOURCE DATA
‚îÇ
‚îÇ  Colors Database:
‚îÇ  ‚îú‚îÄ Rows: 273
‚îÇ  ‚îî‚îÄ Columns: 8
‚îÇ
‚îÇ  Part Mappings (BA ‚Üî RB): base_part_mapping_2026-02-13.xlsx
‚îÇ  ‚îú‚îÄ Rows: 4446
‚îÇ  ‚îî‚îÄ Columns: 84
‚îÇ
‚îÇ  Custom Mappings: 13 rules
‚îÇ
‚îú‚îÄ CACHE DATA
‚îÇ
‚îÇ  ‚îú‚îÄ BrickArchitect images: 1716
‚îÇ  ‚îú‚îÄ Rebrickable images: 937
‚îÇ  ‚îú‚îÄ Label files: 4113
‚îÇ  ‚îî‚îÄ Set inventories: 19
‚îÇ
‚îú‚îÄ CORE MODULE DISTRIBUTION
‚îÇ
‚îÇ  ‚îú‚îÄ core/auth/: 3 module(s)
‚îÇ  ‚îú‚îÄ core/data/: 4 module(s)
‚îÇ  ‚îú‚îÄ core/external/: 2 module(s)
‚îÇ  ‚îú‚îÄ core/infrastructure/: 2 module(s)
‚îÇ  ‚îú‚îÄ core/labels/: 2 module(s)
‚îÇ  ‚îú‚îÄ core/parts/: 3 module(s)
‚îÇ  ‚îú‚îÄ core/state/: 2 module(s)
‚îÇ
‚îî‚îÄ DATA STRUCTURE DIMENSIONS

   DataFrame Schemas:
   ‚îú‚îÄ wanted_df: ~3 columns (Part, Color, Quantity_wanted)
   ‚îú‚îÄ collection_df: ~5 columns (Part, Color, Quantity, Location, Second_location)
   ‚îî‚îÄ merged_df: ~10 columns (includes Available, Quantity_have, Quantity_similar, Replacement_parts)

   Dictionary Structures:
   ‚îú‚îÄ found_counts: {(part, color, location): count}
   ‚îú‚îÄ set_found_counts: {(part, color, set_key): count}
   ‚îú‚îÄ locations_index: {location: [image_urls]}
   ‚îú‚îÄ ba_mapping: {rb_part_number: ba_part_number}
   ‚îú‚îÄ color_lookup: {color_id: {name, rgb, is_trans}}
   ‚îî‚îÄ sets_inventories_cache: {set_number: {set_number, set_name, parts, total_parts}}

================================================================================
STATISTICS SUMMARY
================================================================================
Total Functions: 164
Total Classes: 11
Session State Keys: 18
Modules Analyzed: 23</pre>
        </div>
        
        <footer>
            <p class="timestamp">Generated on 2026-02-27 00:26:38</p>
        </footer>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script>
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        function toggleFolder(folderId) {
            const content = document.getElementById(folderId + '-content');
            const icon = document.getElementById(folderId + '-icon');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('rotated');
            } else {
                content.classList.add('expanded');
                icon.classList.add('rotated');
            }
        }
        
        function toggleFile(fileId) {
            const content = document.getElementById(fileId + '-content');
            const icon = document.getElementById(fileId + '-icon');
            
            if (content.classList.contains('expanded')) {
                content.classList.remove('expanded');
                icon.classList.remove('rotated');
            } else {
                content.classList.add('expanded');
                icon.classList.add('rotated');
            }
        }
        
        // Expand all folders and files
        function expandAll() {
            document.querySelectorAll('.folder-content, .functions-container').forEach(el => {
                el.classList.add('expanded');
            });
            document.querySelectorAll('.expand-icon').forEach(icon => {
                icon.classList.add('rotated');
            });
        }
        
        // Collapse all folders and files
        function collapseAll() {
            document.querySelectorAll('.folder-content, .functions-container').forEach(el => {
                el.classList.remove('expanded');
            });
            document.querySelectorAll('.expand-icon').forEach(icon => {
                icon.classList.remove('rotated');
            });
        }
        
        // Initialize page distribution chart
        const pageData = {"1_Rebrickable_Storage": 90, "2_My_Collection_Parts": 697, "3_My_Collection_Sets": 403, "4_Find_Wanted_Parts": 351};
        const ctx = document.getElementById('pageChart');
        if (ctx && Object.keys(pageData).length > 0) {
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(pageData),
                    datasets: [{
                        label: 'Lines of Code per Page',
                        data: Object.values(pageData),
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)',
                            'rgba(33, 150, 243, 0.8)',
                            'rgba(76, 175, 80, 0.8)'
                        ],
                        borderColor: [
                            'rgba(102, 126, 234, 1)',
                            'rgba(118, 75, 162, 1)',
                            'rgba(33, 150, 243, 1)',
                            'rgba(76, 175, 80, 1)'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        title: {
                            display: true,
                            text: 'Code Complexity by Page (Lines of Code)'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 50
                            }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
